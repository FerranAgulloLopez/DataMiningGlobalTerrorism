Vueling <- read.table("clipboard", header = T, sep = '\t')
Vueling_retraso <- Vueling$RETRASO
Vueling_retraso
#Ryanair
Ryanair <- read.table ("clipboard", header = T, sep = '\t')
Ryanair_retraso <- Ryanair$RETRASO
#Air_Europa
Air_Europa <- read.table ("clipboard", header = T, sep = '\t')
Air_Europa_retraso <- Air_Europa$RETRASO
#Norwegian airlines
Norwegian_airlines <- read.table ("clipboard", header = T, sep = '\t')
Norwegian_airlines_retraso <- Norwegian_airlines$RETRASO
#Iberia
Iberia <- read.table ("clipboard", header = T, sep = '\t')
Iberia_retraso <- Iberia$RETRASO
#var.tests()
var.test(Vueling_retraso, Ryanair_retraso)
var.test(Vueling_retraso, Air_Europa_retraso)
var.test(Vueling_retraso, Norwegian_airlines_retraso)
var.test(Vueling_retraso, Iberia_retraso)
var.test(Ryanair_retraso, Air_Europa_retraso)
var.test(Ryanair_retraso, Norwegian_airlines_retraso)
var.test(Ryanair_retraso, Iberia_retraso)
var.test(Air_Europa_retraso, Norwegian_airlines_retraso)
var.test(Air_Europa_retraso, Iberia_retraso)
var.test(Norwegian_airlines_retraso, Iberia_retraso)
t.test(Vueling_retraso, Ryanair_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_retraso, Norwegian_airlines_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Ryanair_retraso, Norwegian_airlines_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Norwegian_airlines_retraso, Ryanair_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Iberia_retraso, Vueling_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Iberia_retraso, Ryanair_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Iberia_retraso, Air_Europa_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_retraso, Iberia_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
mean(Vueling_retraso)
sd(Vueling_retraso)
mean(Ryanair_retraso)
sd(Ryanair_retraso)
mean(Air_Europa_retraso)
sd(Air_Europa_retraso)
mean(Norwegian_airlines_retraso)
sd(Norwegian_airlines_retraso)
mean(Iberia_retraso)
sd(Iberia_retraso)
hits(Vueling_retraso)
hist(Vueling_retraso)
boxplot(Vueling_retraso)
qqnorm(Vueling_retraso)
qqline(Vueling_retraso)
hist(Vueling_retraso)
Vueling <- read.table("clipboard", header = T, sep = '\t')
Vueling_retraso <- Vueling$RETRASO
mean(Vueling_retraso)
sd(Vueling_retraso)
hist(Vueling_retraso)
boxplot(Vueling_retraso)
qqnorm(Vueling_retraso)
qqline(Vueling_retraso)
Ryanair <- read.table ("clipboard", header = T, sep = '\t')
Ryanair_retraso <- Ryanair$RETRASO
mean(Ryanair_retraso)
sd(Ryanair_retraso)
Ryanair <- read.table ("clipboard", header = T, sep = '\t')
Ryanair_retraso <- Ryanair$RETRASO
mean(Ryanair_retraso)
sd(Ryanair_retraso)
hist(Ryanair_retraso)
boxplot(Ryanair_retraso)
qqnorm(Ryanair_retraso)
qqline(Ryanair_retraso)
Ryanair <- read.table ("clipboard", header = T, sep = '\t')
Ryanair_retraso <- Ryanair$RETRASO
mean(Ryanair_retraso)
sd(Ryanair_retraso)
hist(Ryanair_retraso)
boxplot(Ryanair_retraso)
qqnorm(Ryanair_retraso)
qqline(Ryanair_retraso)
var.test(Vueling_retraso, Ryanair_retraso)
var.test(Vueling_retraso, Air_Europa_retraso)
var.test(Vueling_retraso, Norwegian_airlines_retraso)
var.test(Vueling_retraso, Iberia_retraso)
var.test(Ryanair_retraso, Air_Europa_retraso)
var.test(Ryanair_retraso, Norwegian_airlines_retraso)
var.test(Ryanair_retraso, Iberia_retraso)
var.test(Air_Europa_retraso, Norwegian_airlines_retraso)
var.test(Air_Europa_retraso, Iberia_retraso)
var.test(Norwegian_airlines_retraso, Iberia_retraso)
t.test(Vueling_retraso, Ryanair_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_retraso, Norwegian_airlines_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Norwegian_airlines_retraso, Ryanair_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Ryanair_retraso, Norwegian_airlines_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Iberia_retraso, Vueling_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_retraso, Iberia_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_retraso, Ryanair_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
Air_Europa_Octubre <- read.table ("clipboard", header = T, sep = '\t')
Air_Europa_Octubre_retraso <- Air_Europa_Octubre&RETRASO
Air_Europa_Octubre_retraso <- Air_Europa_Octubre&RETRASO
Air_Europa_Octubre_retraso <- Air_Europa_Octubre$RETRASO
Air_Europa_Noviembre <- read.table ("clipboard", header = T, sep = '\t')
Air_Europa_Noviembre_retraso <- Air_Europa_Noviembre$RETRASO
Air_Europa_Diciembre <- read.table ("clipboard", header = T, sep = '\t')
Air_Europa_Diciembre_retraso <- Air_Europa_Diciembre$RETRASO
var.test(Air_Europa_Octubre_retraso, Air_Europa_Noviembre_retraso)
var.test(Air_Europa_Octubre_retraso, Air_Europa_Diciembre_retraso)
var.test(Air_Europa_Noviembre_retraso, Air_Europa_Diciembre_retraso)
t.test(Air_Europa_Octubre_retraso, Air_Europa_Noviembre_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_Octubre_retraso, Air_Europa_Diciembre_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_Noviembre_retraso, Air_Europa_Diciembre_retraso, var.equal=T, paired=F, mu=0, conf.level = 0.99, alternative = "less")
t.test(Air_Europa_Octubre_retraso, Air_Europa_Diciembre_retraso, var.equal=F, paired=F, mu=0, conf.level = 0.85, alternative = "less")
save.image("C:\\Users\\ad\\Desktop\\Area De Trabajo R")
qqnorm(Vueling_retraso)
qqline(Vueling_retraso)
qqnorm(Ryanair_retraso)
qqline(Ryanair_retraso)
qqnorm(Air_Europa_retraso)
qqline(Air_Europa_retraso)
qqnorm(Norwegian_airlines_retraso)
qqline(Norwegian_airlines_retraso)
qqnorm(Iberia_retraso)
qqline(Iberia_retraso)
q()
setwd("C:/Users/ad/Desktop/Rubén/Uni/MD/MD_Global_Terrorism/second_delivery/datasets")
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
View(dd)
dd <- read.table("credscoClean.csv",header=T, sep=";");
summary(dd$nkill)
summary(dd$nkillus)
summary(dd$nkillter)
summary(dd$nwound)
summary(dd$nwoundus)
summary(dd$nwounte)
summary(dd$nwounter)
summary(dd$nwoundte)
dd$longitude[which(dd$nkillter == NA)] <- 0
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
View(dd)
dd$nkillter[which(dd$nkillter == NA)] <- 0
View(dd)
dd$nkillter[which(is.na(dd$nkillter))] <- 0
summary(dd$nkillter)
dd$nwoundus[which(is.na(dd$nwounus))] <- 0
View(dd)
summary(dd$nwoundus)
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
summary(dd$nwoundus)
summary(dd$nwoundte)
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
summary(dd$nwoundte)
summary(dd$propvalue)
pc1 <- prcomp(dd, scale=TRUE)
summary((nperps))
summary(nperps)
summary(dd$nperps)
summary(dd$nperpcap)
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dd, scale=TRUE)
dcon <- data.frame (as.numeric(dd$nkill),as.numeric(dd$nkillus),as.numeric(dd$nkillter),as.numeric(dd$nwound),as.numeric(dd$nwoundus),as.numeric(dd$nwoundte)
pc1 <- prcomp(dd, scale=TRUE)
dcon <- data.frame (as.numeric(dd$nkill),as.numeric(dd$nkillus),as.numeric(dd$nkillter),as.numeric(dd$nwound),as.numeric(dd$nwoundus),as.numeric(dd$nwoundte)
dcon <- data.frame (as.numeric(dd$nkill),as.numeric(dd$nkillus),as.numeric(dd$nkillter),as.numeric(dd$nwound),as.numeric(dd$nwoundus),as.numeric(dd$nwoundte))
dcon <- data.frame (as.numeric(dd$nkill),as.numeric(dd$nkillus),as.numeric(dd$nkillter),as.numeric(dd$nwound),as.numeric(dd$nwoundus),as.numeric(dd$nwoundte))
pc1 <- prcomp(dd, scale=TRUE)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
fullVariables<-c(2,4,5,9,13,14)
aux<-dd[,fullvariables]
dim(aux)
names(aux)
aux<-dd[,fullvariables]
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
nd = 3
Psi = pc1$x[,1:nd]
iden = row.names(dcon)
etiq = names(dcon)
ze = rep(0,length(etiq)) # WE WILL NEED THIS VECTOR AFTERWARDS FOR THE GRAPHICS
#select your axis
eje1<-1
eje2<-2
plot(Psi[,eje1],Psi[,eje2])
text(Psi[,eje1],Psi[,eje2],labels=iden, cex=0.5)
axis(side=1, pos= 0, labels = F, col="cyan")
axis(side=3, pos= 0, labels = F, col="cyan")
axis(side=2, pos= 0, labels = F, col="cyan")
axis(side=4, pos= 0, labels = F, col="cyan")
Phi = cor(dcon,Psi)
X<-Phi[,eje1]
Y<-Phi[,eje2]
plot(Psi[,eje1],Psi[,eje2],type="n")
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
#zooms
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
nd = 3
Psi = pc1$x[,1:nd]
iden = row.names(dcon)
etiq = names(dcon)
ze = rep(0,length(etiq)) # WE WILL NEED THIS VECTOR AFTERWARDS FOR THE GRAPHICS
#select your axis
eje1<-1
eje2<-2
plot(Psi[,eje1],Psi[,eje2])
text(Psi[,eje1],Psi[,eje2],labels=iden, cex=0.5)
axis(side=1, pos= 0, labels = F, col="cyan")
axis(side=3, pos= 0, labels = F, col="cyan")
axis(side=2, pos= 0, labels = F, col="cyan")
axis(side=4, pos= 0, labels = F, col="cyan")
Phi = cor(dcon,Psi)
X<-Phi[,eje1]
Y<-Phi[,eje2]
plot(Psi[,eje1],Psi[,eje2],type="n")
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
#zooms
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
summary(dd$nperps)
summary(as.factor(dd$nperps))
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
knitr::opts_chunk$set(echo = TRUE)
mydata = read.csv("../../primera_entrega/datasets/preprocessed_dataset.csv")
dd <- read.table("longitudeFixed.csv",header=T, sep=",")
fips-codes-added
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
dd <- read.table("fips-codes-added.csv",header=T, sep=";")
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
setwd("C:/Users/ad/Desktop/Rubén/Uni/MD/MD_Global_Terrorism/second_delivery/datasets")
dd <- read.table("fips-codes-added.csv",header=T, sep=",")
dd <- read.table("fips-codes-added.csv")
dd <- read.csv("fips-codes-added.csv")
View(dd)
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
summary(as.factor(dd$nperps))
summary(as.factor(dd$nperpcap))
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
nd = 3
dd <- read.csv("fips-codes-added.csv")
dd<-dd[which(!is.na(dd$nkillter))]
dd<-dd(which(!is.na(dd$nkillter)))
dd[complete.cases(dd[ , 1:2:3:4]),]
dd[complete.cases(dd[ , 1:13]),]
dd<-dd[complete.cases(dd[ , 1:13]),]
View(dd)
dd<-dd[complete.cases(dd[ , 14:24]),]
dd <- read.csv("fips-codes-added.csv")
dd<-dd[complete.cases(dd[ , 14:24]),]
View(dd)
dd <- read.csv("fips-codes-added.csv")
dd<-dd[complete.cases(dd[ , 14:25]),]
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
dd <- read.csv("fips-codes-added.csv")
dd<-dd[which(!is.na(dd$nkillter))]
dd<-dd[complete.cases(dd[ , 14:24]),]
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
nd = 3
Psi = pc1$x[,1:nd]
iden = row.names(dcon)
etiq = names(dcon)
ze = rep(0,length(etiq)) # WE WILL NEED THIS VECTOR AFTERWARDS FOR THE GRAPHICS
#select your axis
eje1<-1
eje2<-2
plot(Psi[,eje1],Psi[,eje2])
text(Psi[,eje1],Psi[,eje2],labels=iden, cex=0.5)
axis(side=1, pos= 0, labels = F, col="cyan")
axis(side=3, pos= 0, labels = F, col="cyan")
axis(side=2, pos= 0, labels = F, col="cyan")
axis(side=4, pos= 0, labels = F, col="cyan")
Phi = cor(dcon,Psi)
X<-Phi[,eje1]
Y<-Phi[,eje2]
plot(Psi[,eje1],Psi[,eje2],type="n")
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
#zooms
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
dd <- read.csv("fips-codes-added.csv")
dd<-dd[complete.cases(dd[ , 14:24]),]
dcon <- data.frame (dd$nperps,dd$nperpcap,dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
nd = 3
Psi = pc1$x[,1:nd]
iden = row.names(dcon)
etiq = names(dcon)
ze = rep(0,length(etiq)) # WE WILL NEED THIS VECTOR AFTERWARDS FOR THE GRAPHICS
#select your axis
eje1<-1
eje2<-2
plot(Psi[,eje1],Psi[,eje2])
text(Psi[,eje1],Psi[,eje2],labels=iden, cex=0.5)
axis(side=1, pos= 0, labels = F, col="cyan")
axis(side=3, pos= 0, labels = F, col="cyan")
axis(side=2, pos= 0, labels = F, col="cyan")
axis(side=4, pos= 0, labels = F, col="cyan")
Phi = cor(dcon,Psi)
X<-Phi[,eje1]
Y<-Phi[,eje2]
plot(Psi[,eje1],Psi[,eje2],type="n")
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
#zooms
plot(Psi[,eje1],Psi[,eje2],type="n",xlim=c(min(X,0),max(X,0)))
axis(side=1, pos= 0, labels = F)
axis(side=3, pos= 0, labels = F)
axis(side=2, pos= 0, labels = F)
axis(side=4, pos= 0, labels = F)
arrows(ze, ze, X, Y, length = 0.07,col="blue")
text(X,Y,labels=etiq,col="darkblue", cex=0.7)
dd <- read.csv("fips-codes-added.csv")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
dcon <- data.frame (dd$nperps,dd$nperpcap,dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
dd <- read.csv("fips-codes-added.csv")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
dcon <- data.frame (dd$nkill,dd$nkillus,dd$nkillter,dd$nwound,dd$nwoundus,dd$nwoundte)
pc1 <- prcomp(dcon, scale=TRUE)
class(pc1)
attributes(pc1)
print(pc1)
# WHICH PERCENTAGE OF THE TOTAL INERTIA IS REPRESENTED IN SUBSPACES?
pc1$sdev
inerProj<- pc1$sdev^2
inerProj
totalIner<- sum(inerProj)
totalIner
pinerEix<- 100*inerProj/totalIner
pinerEix
barplot(pinerEix)
#Cummulated Inertia in subspaces, from first principal component to the 11th dimension subspace
barplot(100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2])
percInerAccum<-100*cumsum(pc1$sdev[1:dim(dcon)[2]]^2)/dim(dcon)[2]
percInerAccum
dd <- read.csv("fips-codes-added.csv")
#In order to do PCA the data must not have any NA's so we replace NA with
#the value of their medians.
dd$nkillter[which(is.na(dd$nkillter))] <- 0
dd$nwoundus[which(is.na(dd$nwoundus))] <- 0
dd$nwoundte[which(is.na(dd$nwoundte))] <- 0
write.csv(dd, file = "fips-codes-added.csv")
dd <- read.csv("fips-codes-added.csv")
View(dd)
